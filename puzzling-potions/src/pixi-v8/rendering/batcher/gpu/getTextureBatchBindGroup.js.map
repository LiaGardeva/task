{"version":3,"file":"getTextureBatchBindGroup.js","sources":["../../../../src/rendering/batcher/gpu/getTextureBatchBindGroup.ts"],"sourcesContent":["import { BindGroup } from '../../renderers/gpu/shader/BindGroup';\nimport { Texture } from '../../renderers/shared/texture/Texture';\nimport { MAX_TEXTURES } from '../shared/const';\n\nimport type { BindableTexture } from '../../renderers/shared/texture/Texture';\n\nconst cachedGroups: Record<string, BindGroup> = {};\n\nexport function getTextureBatchBindGroup(textures: BindableTexture[])\n{\n    const key = textures.map((t) => t.styleSourceKey).join('-');\n\n    return cachedGroups[key] || generateTextureBatchBindGroup(textures, key);\n}\n\nfunction generateTextureBatchBindGroup(textures: BindableTexture[], key: string): BindGroup\n{\n    const bindGroupResources: Record<string, any> = {};\n\n    let bindIndex = 0;\n\n    for (let i = 0; i < MAX_TEXTURES; i++)\n    {\n        const texture = i < textures.length ? textures[i] : Texture.EMPTY.source;\n\n        bindGroupResources[bindIndex++] = texture.source;\n        bindGroupResources[bindIndex++] = texture.style;\n    }\n\n    // pad out with empty textures\n    const bindGroup = new BindGroup(bindGroupResources);\n\n    cachedGroups[key] = bindGroup;\n\n    return bindGroup;\n}\n\n"],"names":["MAX_TEXTURES","Texture","BindGroup"],"mappings":";;;;;;;;AAMA,MAAM,eAA0C,EAAC,CAAA;AAE1C,SAAS,yBAAyB,QACzC,EAAA;AACI,EAAM,MAAA,GAAA,GAAM,SAAS,GAAI,CAAA,CAAC,MAAM,CAAE,CAAA,cAAc,CAAE,CAAA,IAAA,CAAK,GAAG,CAAA,CAAA;AAE1D,EAAA,OAAO,YAAa,CAAA,GAAG,CAAK,IAAA,6BAAA,CAA8B,UAAU,GAAG,CAAA,CAAA;AAC3E,CAAA;AAEA,SAAS,6BAAA,CAA8B,UAA6B,GACpE,EAAA;AACI,EAAA,MAAM,qBAA0C,EAAC,CAAA;AAEjD,EAAA,IAAI,SAAY,GAAA,CAAA,CAAA;AAEhB,EAAA,KAAA,IAAS,CAAI,GAAA,CAAA,EAAG,CAAI,GAAAA,mBAAA,EAAc,CAClC,EAAA,EAAA;AACI,IAAM,MAAA,OAAA,GAAU,IAAI,QAAS,CAAA,MAAA,GAAS,SAAS,CAAC,CAAA,GAAIC,gBAAQ,KAAM,CAAA,MAAA,CAAA;AAElE,IAAmB,kBAAA,CAAA,SAAA,EAAW,IAAI,OAAQ,CAAA,MAAA,CAAA;AAC1C,IAAmB,kBAAA,CAAA,SAAA,EAAW,IAAI,OAAQ,CAAA,KAAA,CAAA;AAAA,GAC9C;AAGA,EAAM,MAAA,SAAA,GAAY,IAAIC,mBAAA,CAAU,kBAAkB,CAAA,CAAA;AAElD,EAAA,YAAA,CAAa,GAAG,CAAI,GAAA,SAAA,CAAA;AAEpB,EAAO,OAAA,SAAA,CAAA;AACX;;;;"}