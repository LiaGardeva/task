{"version":3,"file":"addMaskLocalBounds.mjs","sources":["../../../../src/rendering/mask/shared/addMaskLocalBounds.ts"],"sourcesContent":["import { Matrix } from '../../../maths/Matrix';\nimport { Bounds } from '../../scene/bounds/Bounds';\nimport { getLocalBounds } from '../../scene/bounds/getLocalBounds';\nimport { updateLocalTransform } from '../../scene/utils/updateLocalTransform';\n\nimport type { Container } from '../../scene/Container';\n\nexport function addMaskLocalBounds(mask: Container, bounds: Bounds, localRoot: Container): void\n{\n    const boundsToMask = new Bounds();\n\n    mask.measurable = true;\n\n    const relativeMask = getMatrixRelativeToParent(mask, localRoot, new Matrix());\n\n    getLocalBounds(mask, boundsToMask, relativeMask);\n\n    // // transform bounds to\n    mask.measurable = false;\n\n    bounds.addBoundsMask(boundsToMask);\n}\n\nexport function getMatrixRelativeToParent(target: Container, root: Container, matrix: Matrix): Matrix\n{\n    if (!target)\n    {\n        // we have reach the top of the tree!\n        console.warn('Item is not inside the root container');\n\n        return matrix;\n    }\n\n    if (target !== root)\n    {\n        getMatrixRelativeToParent(target.parent, root, matrix);\n\n        if (target.didChange)\n        {\n            updateLocalTransform(target.localTransform, target);\n        }\n\n        matrix.append(target.localTransform);\n    }\n\n    return matrix;\n}\n"],"names":[],"mappings":";;;;;AAOgB,SAAA,kBAAA,CAAmB,IAAiB,EAAA,MAAA,EAAgB,SACpE,EAAA;AACI,EAAM,MAAA,YAAA,GAAe,IAAI,MAAO,EAAA,CAAA;AAEhC,EAAA,IAAA,CAAK,UAAa,GAAA,IAAA,CAAA;AAElB,EAAA,MAAM,eAAe,yBAA0B,CAAA,IAAA,EAAM,SAAW,EAAA,IAAI,QAAQ,CAAA,CAAA;AAE5E,EAAe,cAAA,CAAA,IAAA,EAAM,cAAc,YAAY,CAAA,CAAA;AAG/C,EAAA,IAAA,CAAK,UAAa,GAAA,KAAA,CAAA;AAElB,EAAA,MAAA,CAAO,cAAc,YAAY,CAAA,CAAA;AACrC,CAAA;AAEgB,SAAA,yBAAA,CAA0B,MAAmB,EAAA,IAAA,EAAiB,MAC9E,EAAA;AACI,EAAA,IAAI,CAAC,MACL,EAAA;AAEI,IAAA,OAAA,CAAQ,KAAK,uCAAuC,CAAA,CAAA;AAEpD,IAAO,OAAA,MAAA,CAAA;AAAA,GACX;AAEA,EAAA,IAAI,WAAW,IACf,EAAA;AACI,IAA0B,yBAAA,CAAA,MAAA,CAAO,MAAQ,EAAA,IAAA,EAAM,MAAM,CAAA,CAAA;AAErD,IAAA,IAAI,OAAO,SACX,EAAA;AACI,MAAqB,oBAAA,CAAA,MAAA,CAAO,gBAAgB,MAAM,CAAA,CAAA;AAAA,KACtD;AAEA,IAAO,MAAA,CAAA,MAAA,CAAO,OAAO,cAAc,CAAA,CAAA;AAAA,GACvC;AAEA,EAAO,OAAA,MAAA,CAAA;AACX;;;;"}