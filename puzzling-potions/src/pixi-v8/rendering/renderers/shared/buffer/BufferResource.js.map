{"version":3,"file":"BufferResource.js","sources":["../../../../../src/rendering/renderers/shared/buffer/BufferResource.ts"],"sourcesContent":["import EventEmitter from 'eventemitter3';\nimport { generateUID } from '../texture/utils/generateUID';\n\nimport type { BindResource } from '../../gpu/shader/BindResource';\nimport type { Buffer } from './Buffer';\n\nexport class BufferResource extends EventEmitter<{\n    'change': BindResource,\n}> implements BindResource\n{\n    readonly uid = generateUID();\n\n    resourceType = 'bufferResource';\n\n    // this really means ths the buffer resource cannot be updated!\n    resourceId = generateUID();\n\n    buffer: Buffer;\n    readonly offset: number;\n    readonly size: number;\n    readonly bufferResource = true;\n\n    constructor({ buffer, offset, size }: { buffer: Buffer; offset: number; size: number; })\n    {\n        super();\n\n        this.buffer = buffer;\n        this.offset = offset;\n        this.size = size;\n\n        this.buffer.on('change', this.onBufferChange, this);\n    }\n\n    protected onBufferChange(): void\n    {\n        this.resourceId = generateUID();\n\n        this.emit('change', this);\n    }\n\n    destroy(destroyBuffer = false): void\n    {\n        if (destroyBuffer)\n        {\n            this.buffer.destroy();\n        }\n\n        this.buffer = null;\n    }\n}\n"],"names":["EventEmitter","generateUID"],"mappings":";;;;;;;;;;;AAMO,MAAM,uBAAuBA,gCAGpC,CAAA;AAAA,EAaI,WAAY,CAAA,EAAE,MAAQ,EAAA,MAAA,EAAQ,MAC9B,EAAA;AACI,IAAM,KAAA,EAAA,CAAA;AAdV,IAAA,IAAA,CAAS,MAAMC,uBAAY,EAAA,CAAA;AAE3B,IAAe,IAAA,CAAA,YAAA,GAAA,gBAAA,CAAA;AAGf;AAAA,IAAA,IAAA,CAAA,UAAA,GAAaA,uBAAY,EAAA,CAAA;AAKzB,IAAA,IAAA,CAAS,cAAiB,GAAA,IAAA,CAAA;AAMtB,IAAA,IAAA,CAAK,MAAS,GAAA,MAAA,CAAA;AACd,IAAA,IAAA,CAAK,MAAS,GAAA,MAAA,CAAA;AACd,IAAA,IAAA,CAAK,IAAO,GAAA,IAAA,CAAA;AAEZ,IAAA,IAAA,CAAK,MAAO,CAAA,EAAA,CAAG,QAAU,EAAA,IAAA,CAAK,gBAAgB,IAAI,CAAA,CAAA;AAAA,GACtD;AAAA,EAEU,cACV,GAAA;AACI,IAAA,IAAA,CAAK,aAAaA,uBAAY,EAAA,CAAA;AAE9B,IAAK,IAAA,CAAA,IAAA,CAAK,UAAU,IAAI,CAAA,CAAA;AAAA,GAC5B;AAAA,EAEA,OAAA,CAAQ,gBAAgB,KACxB,EAAA;AACI,IAAA,IAAI,aACJ,EAAA;AACI,MAAA,IAAA,CAAK,OAAO,OAAQ,EAAA,CAAA;AAAA,KACxB;AAEA,IAAA,IAAA,CAAK,MAAS,GAAA,IAAA,CAAA;AAAA,GAClB;AACJ;;;;"}