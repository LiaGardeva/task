{"version":3,"file":"Pool.js","sources":["../../../src/utils/pool/Pool.ts"],"sourcesContent":["export class Pool<T extends PoolItem>\n{\n    public readonly _classType: PoolItemConstructor<T>;\n    private readonly _pool: T[] = [];\n    private _count = 0;\n    private _index = 0;\n\n    constructor(ClassType: PoolItemConstructor<T>, initialSize?: number)\n    {\n        this._classType = ClassType;\n\n        if (initialSize)\n        {\n            this.prepopulate(initialSize);\n        }\n    }\n\n    public prepopulate(total: number): void\n    {\n        for (let i = 0; i < total; i++)\n        {\n            this._pool[this._index++] = new this._classType();\n        }\n\n        this._count += total;\n    }\n\n    public get(data?: unknown): T\n    {\n        let item;\n\n        if (this._index > 0)\n        {\n            item = this._pool[--this._index];\n        }\n        else\n        {\n            item = new this._classType();\n        }\n\n        item.init?.(data);\n\n        return item;\n    }\n\n    public return(item: T): void\n    {\n        item.reset?.();\n\n        this._pool[this._index++] = item;\n    }\n\n    get totalSize(): number\n    {\n        return this._count;\n    }\n\n    get totalFree(): number\n    {\n        return this._pool.length;\n    }\n\n    get totalUsed(): number\n    {\n        return this._count - this._pool.length;\n    }\n}\n\nexport type PoolItem = {\n    init?: (data?: any) => void;\n    reset?: () => void;\n};\n\nexport type PoolItemConstructor<K extends PoolItem> = new () => K;\n"],"names":[],"mappings":";;;;AAAO,MAAM,IACb,CAAA;AAAA,EAMI,WAAA,CAAY,WAAmC,WAC/C,EAAA;AALA,IAAA,IAAA,CAAiB,QAAa,EAAC,CAAA;AAC/B,IAAA,IAAA,CAAQ,MAAS,GAAA,CAAA,CAAA;AACjB,IAAA,IAAA,CAAQ,MAAS,GAAA,CAAA,CAAA;AAIb,IAAA,IAAA,CAAK,UAAa,GAAA,SAAA,CAAA;AAElB,IAAA,IAAI,WACJ,EAAA;AACI,MAAA,IAAA,CAAK,YAAY,WAAW,CAAA,CAAA;AAAA,KAChC;AAAA,GACJ;AAAA,EAEO,YAAY,KACnB,EAAA;AACI,IAAA,KAAA,IAAS,CAAI,GAAA,CAAA,EAAG,CAAI,GAAA,KAAA,EAAO,CAC3B,EAAA,EAAA;AACI,MAAA,IAAA,CAAK,MAAM,IAAK,CAAA,MAAA,EAAQ,CAAI,GAAA,IAAI,KAAK,UAAW,EAAA,CAAA;AAAA,KACpD;AAEA,IAAA,IAAA,CAAK,MAAU,IAAA,KAAA,CAAA;AAAA,GACnB;AAAA,EAEO,IAAI,IACX,EAAA;AACI,IAAI,IAAA,IAAA,CAAA;AAEJ,IAAI,IAAA,IAAA,CAAK,SAAS,CAClB,EAAA;AACI,MAAA,IAAA,GAAO,IAAK,CAAA,KAAA,CAAM,EAAE,IAAA,CAAK,MAAM,CAAA,CAAA;AAAA,KAGnC,MAAA;AACI,MAAO,IAAA,GAAA,IAAI,KAAK,UAAW,EAAA,CAAA;AAAA,KAC/B;AAEA,IAAA,IAAA,CAAK,OAAO,IAAI,CAAA,CAAA;AAEhB,IAAO,OAAA,IAAA,CAAA;AAAA,GACX;AAAA,EAEO,OAAO,IACd,EAAA;AACI,IAAA,IAAA,CAAK,KAAQ,IAAA,CAAA;AAEb,IAAK,IAAA,CAAA,KAAA,CAAM,IAAK,CAAA,MAAA,EAAQ,CAAI,GAAA,IAAA,CAAA;AAAA,GAChC;AAAA,EAEA,IAAI,SACJ,GAAA;AACI,IAAA,OAAO,IAAK,CAAA,MAAA,CAAA;AAAA,GAChB;AAAA,EAEA,IAAI,SACJ,GAAA;AACI,IAAA,OAAO,KAAK,KAAM,CAAA,MAAA,CAAA;AAAA,GACtB;AAAA,EAEA,IAAI,SACJ,GAAA;AACI,IAAO,OAAA,IAAA,CAAK,MAAS,GAAA,IAAA,CAAK,KAAM,CAAA,MAAA,CAAA;AAAA,GACpC;AACJ;;;;"}